<UserControl x:Class="DescriptionEditor.Views.DescriptionEditorView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:DescriptionEditor.Views"
             xmlns:interface="clr-namespace:DescriptionEditor.Views.Interface"
             xmlns:pbeh="clr-namespace:CommonPlayniteShared.Behaviors"
             xmlns:convertersshared="clr-namespace:CommonPlayniteShared.Converters"
             mc:Ignorable="d" d:DesignHeight="720" d:DesignWidth="1200">

    <UserControl.Resources>
        <!-- Converters -->
        <convertersshared:InvertedBoolenConverter x:Key="InvertedBoolenConverter"/>

        <!-- Button Styles -->
        <Style x:Key="EditorButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontFamily" Value="{DynamicResource FontIcoFont}"/>
        </Style>

        <Style x:Key="BottomButtonStyle" TargetType="Button" BasedOn="{StaticResource EditorButtonStyle}">
            <Setter Property="Width" Value="100"/>
        </Style>

        <!-- ContextMenus -->
        <ContextMenu x:Key="ImageFormatterMenu">
            <MenuItem Click="BtRemoveImg_Click" Header="{DynamicResource LOCDescriptionEditorButtonRemoveImg}" />
            <MenuItem Click="Bt100PercentImg_Click" Header="{DynamicResource LOCDescriptionEditorButtonAdd100PercentImg}" />
            <MenuItem Click="BtRemoveImgStyle_Click" Header="{DynamicResource LOCDescriptionEditorButtonRemoveStyleImg}" />
            <MenuItem Click="BtCenterImg_Click" Header="{DynamicResource LOCDescriptionEditorButtonCenterImg}" />
        </ContextMenu>

        <ContextMenu x:Key="HtmlFormatMenu">
            <MenuItem Click="BtHtoB_Click" Header="{DynamicResource LOCDescriptionEditorButtonHeaderToBold}" />
            <Separator />
            <MenuItem Click="BtPremove_Click" Header="&lt;p&gt;...&lt;/p&gt; => ...&lt;br&gt;&lt;br&gt;" />
            <MenuItem Click="BtBrtoP_Click" Header="...&lt;br&gt;&lt;br&gt; => &lt;p&gt;...&lt;/p&gt;" />
            <Separator />
            <MenuItem Click="BtBr2to1_Click" Header="&lt;br&gt;&lt;br&gt; => &lt;br&gt;" />
            <MenuItem Click="BtBr3to1_Click" Header="&lt;br&gt;&lt;br&gt;&lt;br&gt; => &lt;br&gt;" />
            <MenuItem Click="BtBr3to2_Click" Header="&lt;br&gt;&lt;br&gt;&lt;br&gt; => &lt;br&gt;&lt;br&gt;" />
        </ContextMenu>

        <ContextMenu x:Key="HtmlSteamMenu">
            <MenuItem Click="SteamRemoveAbout_click" Header="{DynamicResource LOCDescriptionEditorRemoveAboutGame}" />
        </ContextMenu>
    </UserControl.Resources>

    <DockPanel Margin="10" Name="PART_DescriptionView" LastChildFill="True">

        <!-- Toolbar -->
        <Border DockPanel.Dock="Top" BorderThickness="0,0,0,1" BorderBrush="{StaticResource NormalBorderBrush}">
            <DockPanel Margin="0,5">
                <!-- Undo/Redo -->
                <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                    <Button Name="PART_Undo" Content="&#xee0b;" Style="{StaticResource EditorButtonStyle}" Click="PART_Undo_Click" IsEnabled="False"/>
                    <Button Name="PART_Redo" Content="&#xedfe;" Style="{StaticResource EditorButtonStyle}" Click="PART_Redo_Click" IsEnabled="False"/>
                </StackPanel>

                <!-- Image Buttons -->
                <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                    <Button Name="btAddImg" Click="BtAddImg_Click" ToolTip="{DynamicResource LOCDescriptionEditorButtonAddImg}"
                            pbeh:LeftClickContextMenuBehavior.Enabled="True" Style="{StaticResource EditorButtonStyle}">
                        <Grid>
                            <TextBlock Text="&#xef4b;" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBlock Text="&#xefc0;" FontSize="8" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,0,-5,0"/>
                        </Grid>
                        <Button.ContextMenu>
                            <ContextMenu Placement="Bottom" Name="btAddImgContextMenu">
                                <interface:ImageContextMenu BtInsertImgClick="BtInsertImg_Click"/>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>

                    <Button Name="btImageFormatter" Content="&#xef4b;" ToolTip="{DynamicResource LOCDescriptionEditorButtonImageFormatter}" 
                            pbeh:LeftClickContextMenuBehavior.Enabled="True" Style="{StaticResource EditorButtonStyle}" ContextMenu="{StaticResource ImageFormatterMenu}"/>
                </StackPanel>

                <!-- HTML / Markdown Buttons -->
                <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                    <Button Name="btHtmlFormat" Content="&#xe9a8;" FontFamily="{DynamicResource CommonFont}" ToolTip="{DynamicResource LOCDescriptionEditorButtonHtmlFormat}" 
                            Style="{StaticResource EditorButtonStyle}" Click="BtHtmlFormat_Click"/>
                    <Button Name="btHtmlFormatRemove" Content="&#xe9b0;" FontFamily="{DynamicResource CommonFont}" ToolTip="{DynamicResource LOCDescriptionEditorButtonHtmlFormatRemove}" 
                            Style="{StaticResource EditorButtonStyle}" Click="BtHtmlFormatRemove_Click"/>
                    <Button Name="btMarkdownToHtml" Content="{DynamicResource LOCDescriptionEditorButtonMarkdownToHtml}" Style="{StaticResource EditorButtonStyle}" Click="BtMarkdownToHtml_Click"/>
                    <Button Name="btHtmlFormaters" Content="{DynamicResource LOCDescriptionEditorButtonHtmlFormater}" 
                            pbeh:LeftClickContextMenuBehavior.Enabled="True" Style="{StaticResource EditorButtonStyle}" ContextMenu="{StaticResource HtmlFormatMenu}"/>
                    <Button Name="btHtmlFormatSteam" Content="{DynamicResource LOCDescriptionEditorButtonHtmlFormatSteam}" 
                            pbeh:LeftClickContextMenuBehavior.Enabled="True" Style="{StaticResource EditorButtonStyle}" ContextMenu="{StaticResource HtmlSteamMenu}"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Bottom Action Buttons -->
        <Border DockPanel.Dock="Bottom" BorderThickness="0,1,0,0" BorderBrush="{StaticResource NormalBorderBrush}">
            <DockPanel KeyboardNavigation.TabNavigation="Local" LastChildFill="False" Margin="0,5" HorizontalAlignment="Right">
                <Button Name="btEditorOK" Content="{DynamicResource LOCSaveLabel}" IsDefault="True"
                        Style="{StaticResource BottomButtonStyle}" Click="BtEditorOK_Click"/>
                <Button Name="btEditorCancel" Content="{DynamicResource LOCCancelLabel}" IsCancel="True"
                        Style="{StaticResource BottomButtonStyle}" Click="BtEditorCancel_Click"/>
            </DockPanel>
        </Border>

        <!-- Editor Area -->
        <Grid Margin="0,10,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <TextBox Grid.Column="0" Name="DescriptionTextBox" TextWrapping="Wrap" AcceptsReturn="True"
                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                     FontFamily="{DynamicResource MonospaceFontFamily}"
                     Text="{Binding Description, Mode=TwoWay}"
                     PreviewKeyDown="DescriptionTextBox_PreviewKeyDown"
                     TextChanged="DescriptionTextBox_TextChanged"
                     SelectionChanged="DescriptionTextBox_SelectionChanged"/>

            <ScrollViewer Grid.Column="2" ScrollViewer.VerticalScrollBarVisibility="Auto">
                <StackPanel Name="HtmlPreviewPanel" />
            </ScrollViewer>
        </Grid>
    </DockPanel>
</UserControl>